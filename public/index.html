<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KI - Live Trading Sim</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="bg">
  <header class="brandbar">
    <div class="brand-left">
      <img src="/assets/Kent_Invest_Logo.png" alt="Kent Invest" class="brandlogo" />
      <div class="brandtitle">KI - Live Trading Sim</div>
    </div>
    <div class="brand-right">
      <div class="brand-metrics">
        <div class="metric">
          <span class="metric-label">Product</span>
          <span id="productLbl" class="metric-value">Demo Asset</span>
        </div>
        <div class="metric">
          <span class="metric-label">Price</span>
          <span id="priceLbl" class="metric-value">—</span>
        </div>
        <div class="metric">
          <span class="metric-label">Position</span>
          <span id="posLbl" class="metric-value">0</span>
        </div>
        <div class="metric">
          <span class="metric-label">PnL</span>
          <span id="pnlLbl" class="metric-value">0.00</span>
        </div>
        <div class="metric">
          <span class="metric-label">Avg Cost</span>
          <span id="avgLbl" class="metric-value">—</span>
        </div>
      </div>
      <button id="gameFullscreenBtn" type="button" class="fullscreen-btn" data-fullscreen>Enter Fullscreen</button>
    </div>
  </header>

  <!-- JOIN -->
  <section id="joinView" class="center">
    <div class="card">
      <h1>Join the Market</h1>
      <div class="row">
        <input id="nameInput" placeholder="Your name" />
        <button id="joinBtn">Join</button>
      </div>
      <p class="muted" id="joinMsg">Enter your name to join the waiting room.</p>
      <button id="joinFullscreenBtn" type="button" class="fullscreen-btn" data-fullscreen>Enter Fullscreen</button>
    </div>
  </section>

  <!-- WAITING ROOM (shows roster) -->
  <section id="waitView" class="center hidden">
    <div class="card">
      <h2>Waiting for host to start…</h2>
      <p class="muted">You’re in. You’ll switch automatically when the game starts.</p>
      <h3>Players joined</h3>
      <ul id="roster" class="roster"></ul>
      <button id="waitFullscreenBtn" type="button" class="fullscreen-btn" data-fullscreen>Enter Fullscreen</button>
    </div>
  </section>

  <!-- GAME -->
  <section id="gameView" class="page hidden">
    <div id="newsBar" class="news"><span id="newsText">Waiting for news…</span></div>

    <div class="game-shell">
      <div class="left-col">
        <div class="panel card chart-card">
          <div class="panel-header">
            <h3>Price Chart</h3>
            <div class="panel-tools">
              <button id="chartTypeToggle" type="button" class="chip-btn">Show Candles</button>
              <span id="chartModeBadge" class="pill pill-mode">—</span>
            </div>
          </div>
          <div class="chart-wrap">
            <div id="chart" class="chart-surface"></div>
          </div>
        </div>

        <div class="lower-panels">
          <div class="panel card logo-card">
            <img src="/assets/Kent_Invest_Logo.png" alt="Kent Invest" class="floor-logo" />
            <p class="muted">Kent Invest Trading Floor</p>
          </div>

          <div class="panel card chat-card">
            <div class="panel-header">
              <h3>Floor Chat</h3>
            </div>
            <div id="chatLog" class="chat-log"></div>
            <form id="chatForm" class="chat-form">
              <input id="chatInput" placeholder="Say something…" autocomplete="off" />
              <button type="submit">Send</button>
            </form>
          </div>

          <div class="panel card trade-card">
            <div class="panel-header">
              <h3>Order Entry</h3>
              <span id="tradeModeBadge" class="pill pill-mode">—</span>
            </div>
            <form id="tradeForm" class="trade-form">
              <div class="form-row">
                <label>Order Type</label>
                <div class="order-type-toggle">
                  <label><input type="radio" name="orderType" value="market" checked /> Market</label>
                  <label><input type="radio" name="orderType" value="limit" /> Limit</label>
                </div>
              </div>
              <div class="form-row">
                <label for="quantityInput">Quantity</label>
                <input id="quantityInput" type="number" step="1" min="1" value="1" />
              </div>
              <div class="form-row hidden" id="limitPriceRow">
                <label for="priceInput">Limit Price</label>
                <input id="priceInput" type="number" step="0.01" inputmode="decimal" placeholder="Price" />
              </div>
              <div class="form-actions">
                <button type="button" id="sellBtn" class="sell">Sell</button>
                <button type="button" id="buyBtn" class="buy">Buy</button>
              </div>
              <div class="form-subactions">
                <button type="button" id="cancelAllBtn" class="secondary">Cancel All</button>
              </div>
              <div id="tradeStatus" class="trade-status muted"></div>
            </form>
            <div class="open-orders">
              <div class="panel-subheader">Open Orders</div>
              <ul id="openOrders" class="orders-list"></ul>
            </div>
          </div>
        </div>
      </div>

      <div class="dom-col">
        <div class="panel card book-card dom-card">
          <div class="panel-header">
            <h3>Depth of Market</h3>
            <div class="panel-tools book-tools">
              <button id="bookScrollToggle" type="button" class="chip-btn">Auto Scroll: On</button>
              <span id="bookSpread">Spread: —</span>
              <span id="bookModeBadge" class="pill pill-mode">—</span>
            </div>
          </div>
          <div class="dom-header" aria-hidden="true">
            <span>Sell Vol</span>
            <span>Price</span>
            <span>Buy Vol</span>
          </div>
          <div class="orderbook" id="bookBody"></div>
        </div>
      </div>
    </div>
  </section>

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://unpkg.com/lightweight-charts@4.2.1/dist/lightweight-charts.standalone.production.js"></script>
  <script src="script.js"></script>
</body>
</html>
